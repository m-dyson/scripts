#!/bin/bash

########################################
# Stuff to run on a fresh THM Kali box #
########################################

cd ~

local P_THM = '/root/thm'

rm -rf ~/thinclient_drives
rm -rf $P_THM 2> /dev/null

# Get decent ~/.bashrc in root's home dir:
cp /home/kali/.bashrc ~

# Make seprate dir for this THM session:
mkdir -p $P_THM

# Make sure apt repos know of latest versions:
# NB! Is "sudo" prefix necessary?
sudo apt-get update --auto-remove=true

# Install missing packages:
apt install gobuster
apt install tree

# Setting aliases:
echo "alias ll='ls -l'" >> ~/.bashrc
echo "alias la='ls -la'" >> ~/.bashrc

# Get own GH scripts:
local P_SCR = "$P_THM/scripts"
mkdir -p $P_SCR

for s in lhost rhost; do
	fp="$P_SCR/$s"
	wget -O "$fp" "https://raw.githubusercontent.com/m-dyson/scripts/master/$s"
	chmod 700 "$fp"
done

# Write LHOST/RHOST to ~/.bashrc. Requires another cmd (e.g "bash") to get
# the vars in your current shell session!
"$P_SCR/lhost" --force
"$P_SCR/rhost" --force

echo "############################################"
echo "# Enter 'bash' to complete initialization! #"
echo "############################################"
echo